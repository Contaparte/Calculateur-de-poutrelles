// Données des poutrelles en I basées sur les documents PDF - COMPLÈTES
const iJoistData = {
    "AJS® 140": {
        heights: [9.5, 11.875],
        spans: {
            "5/8": {
                "nailed": {
                    "simple": {
                        "no_gypsum": {
                            9.5: {12: "14-7", 16: "13-7", 19.2: "13-1", 24: "n/d"},
                            11.875: {12: "16-5", 16: "15-4", 19.2: "14-9", 24: "n/d"}
                        },
                        "half_gypsum": {
                            9.5: {12: "15-0", 16: "14-0", 19.2: "13-5", 24: "n/d"},
                            11.875: {12: "16-11", 16: "15-9", 19.2: "15-2", 24: "n/d"}
                        }
                    },
                    "multiple": {
                        "no_gypsum": {
                            9.5: {12: "15-10", 16: "14-9", 19.2: "14-2", 24: "n/d"},
                            11.875: {12: "17-10", 16: "16-8", 19.2: "16-0", 24: "n/d"}
                        },
                        "half_gypsum": {
                            9.5: {12: "16-3", 16: "15-2", 19.2: "14-7", 24: "n/d"},
                            11.875: {12: "18-5", 16: "17-2", 19.2: "16-5", 24: "n/d"}
                        }
                    }
                },
                "glued-nailed": {
                    "simple": {
                        "no_gypsum": {
                            9.5: {12: "15-7", 16: "14-9", 19.2: "14-3", 24: "n/d"},
                            11.875: {12: "17-6", 16: "16-6", 19.2: "16-0", 24: "n/d"}
                        },
                        "half_gypsum": {
                            9.5: {12: "16-0", 16: "15-2", 19.2: "14-8", 24: "n/d"},
                            11.875: {12: "18-0", 16: "17-0", 19.2: "16-5", 24: "n/d"}
                        }
                    },
                    "multiple": {
                        "no_gypsum": {
                            9.5: {12: "16-10", 16: "15-11", 19.2: "15-5", 24: "n/d"},
                            11.875: {12: "19-2", 16: "17-10", 19.2: "17-3", 24: "n/d"}
                        },
                        "half_gypsum": {
                            9.5: {12: "17-4", 16: "16-5", 19.2: "15-11", 24: "n/d"},
                            11.875: {12: "19-11", 16: "18-6", 19.2: "17-10", 24: "n/d"}
                        }
                    }
                }
            },
            "3/4": {
                "nailed": {
                    "simple": {
                        "no_gypsum": {
                            9.5: {12: "15-3", 16: "14-3", 19.2: "13-7", 24: "12-11"},
                            11.875: {12: "17-2", 16: "16-0", 19.2: "15-4", 24: "14-7"}
                        },
                        "half_gypsum": {
                            9.5: {12: "15-7", 16: "14-7", 19.2: "13-11", 24: "13-3"},
                            11.875: {12: "17-7", 16: "16-5", 19.2: "15-9", 24: "15-0"}
                        }
                    },
                    "multiple": {
                        "no_gypsum": {
                            9.5: {12: "16-6", 16: "15-5", 19.2: "14-9", 24: "14-1"},
                            11.875: {12: "18-9", 16: "17-4", 19.2: "16-8", 24: "15-10"}
                        },
                        "half_gypsum": {
                            9.5: {12: "16-11", 16: "15-10", 19.2: "15-2", 24: "14-2"},
                            11.875: {12: "19-5", 16: "17-10", 19.2: "17-1", 24: "16-3"}
                        }
                    }
                },
                "glued-nailed": {
                    "simple": {
                        "no_gypsum": {
                            9.5: {12: "16-7", 16: "15-7", 19.2: "15-1", 24: "14-3"},
                            11.875: {12: "18-8", 16: "17-6", 19.2: "16-10", 24: "16-2"}
                        },
                        "half_gypsum": {
                            9.5: {12: "17-0", 16: "16-0", 19.2: "15-6", 24: "14-3"},
                            11.875: {12: "19-3", 16: "18-0", 19.2: "17-4", 24: "16-3"}
                        }
                    },
                    "multiple": {
                        "no_gypsum": {
                            9.5: {12: "17-11", 16: "16-11", 19.2: "15-10", 24: "14-2"},
                            11.875: {12: "20-7", 16: "19-2", 19.2: "18-3", 24: "16-2"}
                        },
                        "half_gypsum": {
                            9.5: {12: "18-6", 16: "17-5", 19.2: "15-10", 24: "14-2"},
                            11.875: {12: "21-4", 16: "19-11", 19.2: "18-1", 24: "16-2"}
                        }
                    }
                }
            }
        }
    },
    "AJS® 20": {
        heights: [9.5, 11.875, 14, 16],
        spans: {
            "5/8": {
                "nailed": {
                    "simple": {
                        "no_gypsum": {
                            9.5: {12: "15-4", 16: "14-4", 19.2: "13-9", 24: "n/d"},
                            11.875: {12: "17-4", 16: "16-2", 19.2: "15-6", 24: "n/d"},
                            14: {12: "19-1", 16: "17-7", 19.2: "16-10", 24: "n/d"},
                            16: {12: "20-10", 16: "19-1", 19.2: "18-1", 24: "n/d"}
                        },
                        "half_gypsum": {
                            9.5: {12: "15-9", 16: "14-8", 19.2: "14-1", 24: "n/d"},
                            11.875: {12: "17-9", 16: "16-6", 19.2: "15-10", 24: "n/d"},
                            14: {12: "19-8", 16: "18-1", 19.2: "17-4", 24: "n/d"},
                            16: {12: "21-6", 16: "19-8", 19.2: "18-8", 24: "n/d"}
                        }
                    },
                    "multiple": {
                        "no_gypsum": {
                            9.5: {12: "16-8", 16: "15-6", 19.2: "14-11", 24: "n/d"},
                            11.875: {12: "18-11", 16: "17-6", 19.2: "16-10", 24: "n/d"},
                            14: {12: "21-2", 16: "19-4", 19.2: "18-5", 24: "n/d"},
                            16: {12: "23-1", 16: "21-2", 19.2: "20-1", 24: "n/d"}
                        },
                        "half_gypsum": {
                            9.5: {12: "17-1", 16: "15-11", 19.2: "15-3", 24: "n/d"},
                            11.875: {12: "19-7", 16: "17-11", 19.2: "17-3", 24: "n/d"},
                            14: {12: "21-10", 16: "20-0", 19.2: "19-0", 24: "n/d"},
                            16: {12: "23-10", 16: "21-11", 19.2: "20-9", 24: "n/d"}
                        }
                    }
                },
                "glued-nailed": {
                    "simple": {
                        "no_gypsum": {
                            9.5: {12: "16-3", 16: "15-4", 19.2: "14-10", 24: "n/d"},
                            11.875: {12: "18-3", 16: "17-2", 19.2: "16-7", 24: "n/d"},
                            14: {12: "20-3", 16: "18-10", 19.2: "18-0", 24: "n/d"},
                            16: {12: "22-1", 16: "20-6", 19.2: "19-7", 24: "n/d"}
                        },
                        "half_gypsum": {
                            9.5: {12: "16-8", 16: "15-9", 19.2: "15-2", 24: "n/d"},
                            11.875: {12: "18-10", 16: "17-8", 19.2: "17-0", 24: "n/d"},
                            14: {12: "21-0", 16: "19-6", 19.2: "18-8", 24: "n/d"},
                            16: {12: "22-10", 16: "21-3", 19.2: "20-4", 24: "n/d"}
                        }
                    },
                    "multiple": {
                        "no_gypsum": {
                            9.5: {12: "17-7", 16: "16-7", 19.2: "16-0", 24: "n/d"},
                            11.875: {12: "20-2", 16: "18-9", 19.2: "18-0", 24: "n/d"},
                            14: {12: "22-6", 16: "20-10", 19.2: "19-11", 24: "n/d"},
                            16: {12: "24-6", 16: "22-8", 19.2: "21-8", 24: "n/d"}
                        },
                        "half_gypsum": {
                            9.5: {12: "18-1", 16: "17-1", 19.2: "16-6", 24: "n/d"},
                            11.875: {12: "20-11", 16: "19-5", 19.2: "18-7", 24: "n/d"},
                            14: {12: "23-3", 16: "21-7", 19.2: "20-8", 24: "n/d"},
                            16: {12: "25-4", 16: "23-7", 19.2: "22-7", 24: "n/d"}
                        }
                    }
                }
            },
            "3/4": {
                "nailed": {
                    "simple": {
                        "no_gypsum": {
                            9.5: {12: "16-1", 16: "15-0", 19.2: "14-4", 24: "13-7"},
                            11.875: {12: "18-1", 16: "16-10", 19.2: "16-1", 24: "15-4"},
                            14: {12: "20-2", 16: "18-5", 19.2: "17-7", 24: "16-9"},
                            16: {12: "22-1", 16: "20-2", 19.2: "19-0", 24: "17-11"}
                        },
                        "half_gypsum": {
                            9.5: {12: "16-5", 16: "15-3", 19.2: "14-8", 24: "13-11"},
                            11.875: {12: "18-7", 16: "17-3", 19.2: "16-6", 24: "15-8"},
                            14: {12: "20-9", 16: "19-0", 19.2: "18-0", 24: "17-1"},
                            16: {12: "22-8", 16: "20-9", 19.2: "19-8", 24: "18-5"}
                        }
                    },
                    "multiple": {
                        "no_gypsum": {
                            9.5: {12: "17-5", 16: "16-3", 19.2: "15-6", 24: "14-9"},
                            11.875: {12: "20-0", 16: "18-4", 19.2: "17-6", 24: "16-8"},
                            14: {12: "22-4", 16: "20-5", 19.2: "19-4", 24: "18-2"},
                            16: {12: "24-5", 16: "22-4", 19.2: "21-2", 24: "19-9"}
                        },
                        "half_gypsum": {
                            9.5: {12: "17-9", 16: "16-7", 19.2: "15-11", 24: "15-1"},
                            11.875: {12: "20-7", 16: "18-11", 19.2: "17-11", 24: "17-1"},
                            14: {12: "23-0", 16: "21-1", 19.2: "20-0", 24: "18-9"},
                            16: {12: "25-1", 16: "23-1", 19.2: "21-10", 24: "19-9"}
                        }
                    }
                },
                "glued-nailed": {
                    "simple": {
                        "no_gypsum": {
                            9.5: {12: "17-3", 16: "16-3", 19.2: "15-8", 24: "15-0"},
                            11.875: {12: "19-7", 16: "18-2", 19.2: "17-6", 24: "16-10"},
                            14: {12: "21-10", 16: "20-2", 19.2: "19-3", 24: "18-3"},
                            16: {12: "23-9", 16: "22-0", 19.2: "20-11", 24: "19-10"}
                        },
                        "half_gypsum": {
                            9.5: {12: "17-7", 16: "16-7", 19.2: "16-0", 24: "15-4"},
                            11.875: {12: "20-2", 16: "18-9", 19.2: "17-11", 24: "17-3"},
                            14: {12: "22-5", 16: "20-10", 19.2: "19-11", 24: "18-11"},
                            16: {12: "24-5", 16: "22-9", 19.2: "21-8", 24: "20-7"}
                        }
                    },
                    "multiple": {
                        "no_gypsum": {
                            9.5: {12: "18-9", 16: "17-7", 19.2: "16-11", 24: "16-3"},
                            11.875: {12: "21-8", 16: "20-1", 19.2: "19-2", 24: "18-3"},
                            14: {12: "24-1", 16: "22-4", 19.2: "21-4", 24: "19-5"},
                            16: {12: "26-3", 16: "24-4", 19.2: "23-2", 24: "19-9"}
                        },
                        "half_gypsum": {
                            9.5: {12: "19-4", 16: "18-0", 19.2: "17-4", 24: "16-8"},
                            11.875: {12: "22-4", 16: "20-10", 19.2: "19-10", 24: "18-10"},
                            14: {12: "24-10", 16: "23-1", 19.2: "22-1", 24: "19-5"},
                            16: {12: "27-1", 16: "25-2", 19.2: "24-1", 24: "19-9"}
                        }
                    }
                }
            }
        }
    },
    "AJS® 25": {
        heights: [9.5, 11.875, 14, 16, 18, 20, 22, 24],
        spans: {
            "5/8": {
                "nailed": {
                    "simple": {
                        "no_gypsum": {
                            9.5: {12: "16-5", 16: "15-4", 19.2: "14-9", 24: "n/d"},
                            11.875: {12: "18-8", 16: "17-3", 19.2: "16-7", 24: "n/d"},
                            14: {12: "20-9", 16: "19-0", 19.2: "18-0", 24: "n/d"},
                            16: {12: "22-8", 16: "20-8", 19.2: "19-8", 24: "n/d"},
                            18: {12: "24-9", 16: "22-7", 19.2: "21-5", 24: "n/d"},
                            20: {12: "26-6", 16: "24-2", 19.2: "22-11", 24: "n/d"},
                            22: {12: "28-2", 16: "25-9", 19.2: "24-5", 24: "n/d"},
                            24: {12: "29-9", 16: "27-2", 19.2: "25-10", 24: "n/d"}
                        },
                        "half_gypsum": {
                            9.5: {12: "16-10", 16: "15-8", 19.2: "15-0", 24: "n/d"},
                            11.875: {12: "19-2", 16: "17-8", 19.2: "16-11", 24: "n/d"},
                            14: {12: "21-4", 16: "19-6", 19.2: "18-6", 24: "n/d"},
                            16: {12: "23-4", 16: "21-4", 19.2: "20-3", 24: "n/d"},
                            18: {12: "25-5", 16: "23-3", 19.2: "22-1", 24: "n/d"},
                            20: {12: "27-2", 16: "24-11", 19.2: "23-8", 24: "n/d"},
                            22: {12: "28-11", 16: "26-6", 19.2: "25-2", 24: "n/d"},
                            24: {12: "30-7", 16: "28-1", 19.2: "26-8", 24: "n/d"}
                        }
                    },
                    "multiple": {
                        "no_gypsum": {
                            9.5: {12: "17-10", 16: "16-8", 19.2: "16-0", 24: "n/d"},
                            11.875: {12: "20-8", 16: "18-11", 19.2: "18-0", 24: "n/d"},
                            14: {12: "23-1", 16: "21-1", 19.2: "20-0", 24: "n/d"},
                            16: {12: "25-2", 16: "23-0", 19.2: "21-10", 24: "n/d"},
                            18: {12: "27-4", 16: "25-1", 19.2: "23-9", 24: "n/d"},
                            20: {12: "29-4", 16: "26-10", 19.2: "25-5", 24: "n/d"},
                            22: {12: "31-2", 16: "28-6", 19.2: "27-1", 24: "n/d"},
                            24: {12: "33-2", 16: "30-2", 19.2: "28-8", 24: "n/d"}
                        },
                        "half_gypsum": {
                            9.5: {12: "18-3", 16: "17-0", 19.2: "16-4", 24: "n/d"},
                            11.875: {12: "21-3", 16: "19-6", 19.2: "18-6", 24: "n/d"},
                            14: {12: "23-9", 16: "21-9", 19.2: "20-7", 24: "n/d"},
                            16: {12: "25-11", 16: "23-9", 19.2: "22-6", 24: "n/d"},
                            18: {12: "28-2", 16: "25-10", 19.2: "24-6", 24: "n/d"},
                            20: {12: "30-2", 16: "27-8", 19.2: "26-3", 24: "n/d"},
                            22: {12: "32-1", 16: "29-5", 19.2: "27-11", 24: "n/d"},
                            24: {12: "34-5", 16: "31-2", 19.2: "29-7", 24: "n/d"}
                        }
                    }
                },
                "glued-nailed": {
                    "simple": {
                        "no_gypsum": {
                            9.5: {12: "17-3", 16: "16-2", 19.2: "15-8", 24: "n/d"},
                            11.875: {12: "19-8", 16: "18-2", 19.2: "17-6", 24: "n/d"},
                            14: {12: "21-10", 16: "20-2", 19.2: "19-3", 24: "n/d"},
                            16: {12: "23-9", 16: "21-11", 19.2: "21-0", 24: "n/d"},
                            18: {12: "25-10", 16: "23-10", 19.2: "22-9", 24: "n/d"},
                            20: {12: "27-7", 16: "25-6", 19.2: "24-4", 24: "n/d"},
                            22: {12: "29-4", 16: "27-1", 19.2: "25-10", 24: "n/d"},
                            24: {12: "31-0", 16: "28-7", 19.2: "27-4", 24: "n/d"}
                        },
                        "half_gypsum": {
                            9.5: {12: "17-7", 16: "16-7", 19.2: "16-0", 24: "n/d"},
                            11.875: {12: "20-2", 16: "18-8", 19.2: "17-11", 24: "n/d"},
                            14: {12: "22-6", 16: "20-10", 19.2: "19-10", 24: "n/d"},
                            16: {12: "24-6", 16: "22-8", 19.2: "21-8", 24: "n/d"},
                            18: {12: "26-7", 16: "24-7", 19.2: "23-6", 24: "n/d"},
                            20: {12: "28-5", 16: "26-4", 19.2: "25-2", 24: "n/d"},
                            22: {12: "30-2", 16: "27-11", 19.2: "26-8", 24: "n/d"},
                            24: {12: "31-11", 16: "29-7", 19.2: "28-3", 24: "n/d"}
                        }
                    },
                    "multiple": {
                        "no_gypsum": {
                            9.5: {12: "18-10", 16: "17-7", 19.2: "16-11", 24: "n/d"},
                            11.875: {12: "21-9", 16: "20-2", 19.2: "19-3", 24: "n/d"},
                            14: {12: "24-2", 16: "22-4", 19.2: "21-4", 24: "n/d"},
                            16: {12: "26-4", 16: "24-4", 19.2: "23-3", 24: "n/d"},
                            18: {12: "28-7", 16: "26-5", 19.2: "25-3", 24: "n/d"},
                            20: {12: "30-7", 16: "28-3", 19.2: "26-11", 24: "n/d"},
                            22: {12: "32-6", 16: "30-0", 19.2: "28-7", 24: "n/d"},
                            24: {12: "34-11", 16: "31-8", 19.2: "30-3", 24: "n/d"}
                        },
                        "half_gypsum": {
                            9.5: {12: "19-4", 16: "18-0", 19.2: "17-4", 24: "n/d"},
                            11.875: {12: "22-5", 16: "20-9", 19.2: "19-10", 24: "n/d"},
                            14: {12: "24-11", 16: "23-1", 19.2: "22-1", 24: "n/d"},
                            16: {12: "27-2", 16: "25-2", 19.2: "24-0", 24: "n/d"},
                            18: {12: "29-5", 16: "27-3", 19.2: "26-1", 24: "n/d"},
                            20: {12: "31-6", 16: "29-2", 19.2: "27-11", 24: "n/d"},
                            22: {12: "33-9", 16: "31-0", 19.2: "29-7", 24: "n/d"},
                            24: {12: "36-4", 16: "32-10", 19.2: "31-4", 24: "n/d"}
                        }
                    }
                }
            },
            "3/4": {
                "nailed": {
                    "simple": {
                        "no_gypsum": {
                            9.5: {12: "17-2", 16: "16-0", 19.2: "15-4", 24: "14-7"},
                            11.875: {12: "19-9", 16: "18-0", 19.2: "17-3", 24: "16-5"},
                            14: {12: "22-0", 16: "20-1", 19.2: "19-0", 24: "17-10"},
                            16: {12: "24-0", 16: "21-11", 19.2: "20-8", 24: "19-5"},
                            18: {12: "26-2", 16: "23-11", 19.2: "22-7", 24: "21-2"},
                            20: {12: "28-0", 16: "25-7", 19.2: "24-2", 24: "22-8"},
                            22: {12: "29-9", 16: "27-2", 19.2: "25-8", 24: "24-1"},
                            24: {12: "31-6", 16: "28-9", 19.2: "27-2", 24: "25-6"}
                        },
                        "half_gypsum": {
                            9.5: {12: "17-6", 16: "16-4", 19.2: "15-7", 24: "14-10"},
                            11.875: {12: "20-2", 16: "18-5", 19.2: "17-7", 24: "16-9"},
                            14: {12: "22-6", 16: "20-7", 19.2: "19-6", 24: "18-3"},
                            16: {12: "24-7", 16: "22-6", 19.2: "21-3", 24: "19-11"},
                            18: {12: "26-9", 16: "24-6", 19.2: "23-2", 24: "21-9"},
                            20: {12: "28-7", 16: "26-3", 19.2: "24-10", 24: "23-4"},
                            22: {12: "30-5", 16: "27-11", 19.2: "26-5", 24: "24-10"},
                            24: {12: "32-2", 16: "29-7", 19.2: "28-0", 24: "26-3"}
                        }
                    },
                    "multiple": {
                        "no_gypsum": {
                            9.5: {12: "18-10", 16: "17-5", 19.2: "16-8", 24: "15-10"},
                            11.875: {12: "21-10", 16: "20-0", 19.2: "18-11", 24: "17-10"},
                            14: {12: "24-4", 16: "22-3", 19.2: "21-1", 24: "19-5"},
                            16: {12: "26-7", 16: "24-4", 19.2: "23-0", 24: "19-9"},
                            18: {12: "28-11", 16: "26-6", 19.2: "25-1", 24: "23-6"},
                            20: {12: "31-0", 16: "28-4", 19.2: "26-10", 24: "25-2"},
                            22: {12: "33-1", 16: "30-2", 19.2: "28-6", 24: "26-9"},
                            24: {12: "35-8", 16: "31-11", 19.2: "30-2", 24: "28-4"}
                        },
                        "half_gypsum": {
                            9.5: {12: "19-3", 16: "17-9", 19.2: "17-0", 24: "16-2"},
                            11.875: {12: "22-5", 16: "20-6", 19.2: "19-5", 24: "18-3"},
                            14: {12: "25-0", 16: "22-11", 19.2: "21-8", 24: "19-5"},
                            16: {12: "27-3", 16: "25-0", 19.2: "23-8", 24: "19-9"},
                            18: {12: "29-7", 16: "27-2", 19.2: "25-9", 24: "24-2"},
                            20: {12: "31-9", 16: "29-2", 19.2: "27-7", 24: "25-11"},
                            22: {12: "34-2", 16: "31-0", 19.2: "29-4", 24: "27-7"},
                            24: {12: "36-10", 16: "32-11", 19.2: "31-1", 24: "29-2"}
                        }
                    }
                },
                "glued-nailed": {
                    "simple": {
                        "no_gypsum": {
                            9.5: {12: "18-3", 16: "17-2", 19.2: "16-6", 24: "15-10"},
                            11.875: {12: "21-1", 16: "19-6", 19.2: "18-7", 24: "17-8"},
                            14: {12: "23-5", 16: "21-8", 19.2: "20-7", 24: "19-6"},
                            16: {12: "25-6", 16: "23-6", 19.2: "22-5", 24: "21-2"},
                            18: {12: "27-7", 16: "25-6", 19.2: "24-4", 24: "23-0"},
                            20: {12: "29-6", 16: "27-3", 19.2: "26-0", 24: "24-7"},
                            22: {12: "31-4", 16: "29-0", 19.2: "27-7", 24: "26-1"},
                            24: {12: "33-4", 16: "30-7", 19.2: "29-1", 24: "27-6"}
                        },
                        "half_gypsum": {
                            9.5: {12: "18-8", 16: "17-6", 19.2: "16-10", 24: "16-2"},
                            11.875: {12: "21-7", 16: "20-0", 19.2: "19-1", 24: "18-1"},
                            14: {12: "24-0", 16: "22-3", 19.2: "21-2", 24: "20-1"},
                            16: {12: "26-1", 16: "24-2", 19.2: "23-1", 24: "21-10"},
                            18: {12: "28-4", 16: "26-3", 19.2: "25-0", 24: "23-8"},
                            20: {12: "30-3", 16: "28-1", 19.2: "26-9", 24: "25-4"},
                            22: {12: "32-2", 16: "29-10", 19.2: "28-5", 24: "26-11"},
                            24: {12: "34-5", 16: "31-6", 19.2: "30-0", 24: "28-5"}
                        }
                    },
                    "multiple": {
                        "no_gypsum": {
                            9.5: {12: "20-2", 16: "18-8", 19.2: "17-11", 24: "17-2"},
                            11.875: {12: "23-4", 16: "21-7", 19.2: "20-7", 24: "19-1"},
                            14: {12: "25-11", 16: "23-11", 19.2: "22-10", 24: "19-5"},
                            16: {12: "28-2", 16: "26-1", 19.2: "24-8", 24: "19-9"},
                            18: {12: "30-7", 16: "28-3", 19.2: "26-11", 24: "25-5"},
                            20: {12: "32-8", 16: "30-2", 19.2: "28-9", 24: "27-2"},
                            22: {12: "35-5", 16: "32-1", 19.2: "30-6", 24: "28-10"},
                            24: {12: "38-1", 16: "34-4", 19.2: "32-3", 24: "30-6"}
                        },
                        "half_gypsum": {
                            9.5: {12: "20-8", 16: "19-2", 19.2: "18-4", 24: "17-6"},
                            11.875: {12: "23-11", 16: "22-2", 19.2: "21-2", 24: "19-1"},
                            14: {12: "26-7", 16: "24-8", 19.2: "23-6", 24: "19-5"},
                            16: {12: "28-11", 16: "26-10", 19.2: "24-8", 24: "19-9"},
                            18: {12: "31-4", 16: "29-1", 19.2: "27-9", 24: "26-3"},
                            20: {12: "33-10", 16: "31-1", 19.2: "29-8", 24: "28-1"},
                            22: {12: "36-7", 16: "33-2", 19.2: "31-6", 24: "29-10"},
                            24: {12: "39-5", 16: "35-9", 19.2: "33-6", 24: "31-6"}
                        }
                    }
                }
            }
        }
    }
};

// Données des poutrelles ajourées basées sur les documents PDF
const openWebJoistData = {
    "40_15": { // 40 lb/pi² live + 15 lb/pi² dead
        "2x3 - EPS": {
            11.875: {12: 19.33, 16: 16.58, 19.2: 15.08, 24: 13.25},
            12.5: {12: 19.92, 16: 17.08, 19.2: 15.5, 24: 13.67},
            14: {12: 21.17, 16: 18.25, 19.2: 16.5, 24: 14.58},
            16: {12: 22.83, 16: 19.58, 19.2: 17.75, 24: 15.58},
            18: {12: 0, 16: 0, 19.2: 0, 24: 0},
            20: {12: 0, 16: 0, 19.2: 0, 24: 0},
            22: {12: 0, 16: 0, 19.2: 0, 24: 0},
            24: {12: 0, 16: 0, 19.2: 0, 24: 0}
        },
        "2x3 - 1650": {
            11.875: {12: 21.5, 16: 19.67, 19.2: 17.83, 24: 15.67},
            12.5: {12: 22.17, 16: 20.25, 19.2: 18.33, 24: 16.17},
            14: {12: 23.83, 16: 21.5, 19.2: 19.58, 24: 17.25},
            16: {12: 25.83, 16: 23.17, 19.2: 21.0, 24: 18.58},
            18: {12: 0, 16: 0, 19.2: 0, 24: 0},
            20: {12: 0, 16: 0, 19.2: 0, 24: 0},
            22: {12: 0, 16: 0, 19.2: 0, 24: 0},
            24: {12: 0, 16: 0, 19.2: 0, 24: 0}
        },
        "2x3 - 2100": {
            11.875: {12: 22.33, 16: 20.83, 19.2: 19.83, 24: 18.33},
            12.5: {12: 23.08, 16: 21.5, 19.2: 20.58, 24: 19.08},
            14: {12: 24.75, 16: 23.17, 19.2: 22.08, 24: 20.83},
            16: {12: 26.83, 16: 25.17, 19.2: 24.0, 24: 22.58},
            18: {12: 0, 16: 0, 19.2: 0, 24: 0},
            20: {12: 0, 16: 0, 19.2: 0, 24: 0},
            22: {12: 0, 16: 0, 19.2: 0, 24: 0},
            24: {12: 0, 16: 0, 19.2: 0, 24: 0}
        },
        "2x4 - 2100": {
            11.875: {12: 24.08, 16: 22.42, 19.2: 21.33, 24: 20.17},
            12.5: {12: 24.83, 16: 23.17, 19.2: 22.08, 24: 20.83},
            14: {12: 26.58, 16: 24.92, 19.2: 23.75, 24: 22.33},
            16: {12: 28.83, 16: 26.92, 19.2: 25.75, 24: 24.25},
            18: {12: 31.0, 16: 29.0, 19.2: 27.67, 24: 26.0},
            20: {12: 32.5, 16: 30.5, 19.2: 29.08, 24: 27.42},
            22: {12: 35.08, 16: 32.25, 19.2: 30.92, 24: 29.08},
            24: {12: 37.5, 16: 34.5, 19.2: 32.5, 24: 30.75}
        },
        "2x4 - 2400": {
            11.875: {12: 24.67, 16: 23.0, 19.2: 21.92, 24: 20.67},
            12.5: {12: 25.5, 16: 23.75, 19.2: 22.67, 24: 21.25},
            14: {12: 27.25, 16: 25.5, 19.2: 24.33, 24: 22.83},
            16: {12: 29.5, 16: 27.58, 19.2: 26.33, 24: 24.83},
            18: {12: 31.67, 16: 29.67, 19.2: 28.33, 24: 26.67},
            20: {12: 34.08, 16: 31.58, 19.2: 30.25, 24: 28.5},
            22: {12: 36.58, 16: 33.67, 19.2: 31.92, 24: 30.17},
            24: {12: 39.17, 16: 36.08, 19.2: 34.0, 24: 31.75}
        }
    },
    "100_15": { // 100 lb/pi² live + 15 lb/pi² dead
        "2x3 - EPS": {
            11.875: {12: 13.17, 16: 10.5, 19.2: 8.92, 24: 6.75},
            12.5: {12: 13.58, 16: 10.75, 19.2: 9.17, 24: 7.0},
            14: {12: 14.42, 16: 11.5, 19.2: 9.75, 24: 7.42},
            16: {12: 15.58, 16: 12.42, 19.2: 10.42, 24: 8.0},
            18: {12: 0, 16: 0, 19.2: 0, 24: 0},
            20: {12: 0, 16: 0, 19.2: 0, 24: 0},
            22: {12: 0, 16: 0, 19.2: 0, 24: 0},
            24: {12: 0, 16: 0, 19.2: 0, 24: 0}
        },
        "2x3 - 1650": {
            11.875: {12: 15.58, 16: 13.33, 19.2: 11.83, 24: 9.58},
            12.5: {12: 15.92, 16: 13.75, 19.2: 12.17, 24: 9.83},
            14: {12: 17.0, 16: 14.67, 19.2: 13.0, 24: 10.42},
            16: {12: 18.33, 16: 15.75, 19.2: 14.0, 24: 11.25},
            18: {12: 0, 16: 0, 19.2: 0, 24: 0},
            20: {12: 0, 16: 0, 19.2: 0, 24: 0},
            22: {12: 0, 16: 0, 19.2: 0, 24: 0},
            24: {12: 0, 16: 0, 19.2: 0, 24: 0}
        },
        "2x3 - 2100": {
            11.875: {12: 16.75, 16: 15.17, 19.2: 13.5, 24: 11.25},
            12.5: {12: 17.42, 16: 15.75, 19.2: 13.92, 24: 11.58},
            14: {12: 19.17, 16: 16.83, 19.2: 14.83, 24: 12.33},
            16: {12: 21.17, 16: 18.17, 19.2: 15.83, 24: 13.25},
            18: {12: 0, 16: 0, 19.2: 0, 24: 0},
            20: {12: 0, 16: 0, 19.2: 0, 24: 0},
            22: {12: 0, 16: 0, 19.2: 0, 24: 0},
            24: {12: 0, 16: 0, 19.2: 0, 24: 0}
        },
        "2x4 - 2100": {
            11.875: {12: 18.67, 16: 16.58, 19.2: 14.42, 24: 11.83},
            12.5: {12: 19.42, 16: 17.08, 19.2: 14.92, 24: 12.17},
            14: {12: 21.25, 16: 18.17, 19.2: 15.83, 24: 13.0},
            16: {12: 23.58, 16: 19.58, 19.2: 17.0, 24: 14.0},
            18: {12: 25.5, 16: 20.83, 19.2: 18.17, 24: 15.0},
            20: {12: 26.92, 16: 22.08, 19.2: 19.25, 24: 15.75},
            22: {12: 28.33, 16: 23.25, 19.2: 20.33, 24: 16.67},
            24: {12: 29.75, 16: 24.42, 19.2: 21.17, 24: 17.42}
        },
        "2x4 - 2400": {
            11.875: {12: 19.33, 16: 17.33, 19.2: 15.5, 24: 12.92},
            12.5: {12: 20.17, 16: 18.08, 19.2: 16.17, 24: 13.33},
            14: {12: 22.0, 16: 19.42, 19.2: 17.0, 24: 14.25},
            16: {12: 24.42, 16: 20.83, 19.2: 18.33, 24: 15.33},
            18: {12: 26.67, 16: 22.25, 19.2: 19.5, 24: 16.25},
            20: {12: 28.42, 16: 23.58, 19.2: 20.75, 24: 17.25},
            22: {12: 30.0, 16: 24.83, 19.2: 21.75, 24: 18.17},
            24: {12: 31.33, 16: 26.0, 19.2: 22.83, 24: 19.08}
        }
    },
    "100_30": { // 100 lb/pi² live + 30 lb/pi² dead
        "2x3 - EPS": {
            11.875: {12: 11.75, 16: 9.25, 19.2: 7.83, 24: 5.92},
            12.5: {12: 12.17, 16: 9.58, 19.2: 8.08, 24: 6.17},
            14: {12: 12.92, 16: 10.17, 19.2: 8.58, 24: 6.50},
            16: {12: 13.92, 16: 10.92, 19.2: 9.17, 24: 7.00},
            18: {12: 0, 16: 0, 19.2: 0, 24: 0},
            20: {12: 0, 16: 0, 19.2: 0, 24: 0},
            22: {12: 0, 16: 0, 19.2: 0, 24: 0},
            24: {12: 0, 16: 0, 19.2: 0, 24: 0}
        },
        "2x3 - 1650": {
            11.875: {12: 14.25, 16: 12.08, 19.2: 10.67, 24: 8.58},
            12.5: {12: 14.58, 16: 12.42, 19.2: 10.92, 24: 8.83},
            14: {12: 15.58, 16: 13.25, 19.2: 11.67, 24: 9.33},
            16: {12: 16.75, 16: 14.17, 19.2: 12.50, 24: 10.08},
            18: {12: 0, 16: 0, 19.2: 0, 24: 0},
            20: {12: 0, 16: 0, 19.2: 0, 24: 0},
            22: {12: 0, 16: 0, 19.2: 0, 24: 0},
            24: {12: 0, 16: 0, 19.2: 0, 24: 0}
        },
        "2x3 - 2100": {
            11.875: {12: 15.50, 16: 13.92, 19.2: 12.25, 24: 10.08},
            12.5: {12: 16.08, 16: 14.42, 19.2: 12.67, 24: 10.42},
            14: {12: 17.58, 16: 15.33, 19.2: 13.50, 24: 11.08},
            16: {12: 19.42, 16: 16.50, 19.2: 14.42, 24: 11.92},
            18: {12: 0, 16: 0, 19.2: 0, 24: 0},
            20: {12: 0, 16: 0, 19.2: 0, 24: 0},
            22: {12: 0, 16: 0, 19.2: 0, 24: 0},
            24: {12: 0, 16: 0, 19.2: 0, 24: 0}
        },
        "2x4 - 2100": {
            11.875: {12: 17.33, 16: 15.08, 19.2: 12.92, 24: 10.50},
            12.5: {12: 18.00, 16: 15.58, 19.2: 13.33, 24: 10.83},
            14: {12: 19.75, 16: 16.58, 19.2: 14.25, 24: 11.58},
            16: {12: 21.92, 16: 17.83, 19.2: 15.33, 24: 12.50},
            18: {12: 23.75, 16: 18.92, 19.2: 16.33, 24: 13.33},
            20: {12: 25.17, 16: 20.00, 19.2: 17.25, 24: 14.08},
            22: {12: 26.42, 16: 21.08, 19.2: 18.17, 24: 14.83},
            24: {12: 27.75, 16: 22.17, 19.2: 19.00, 24: 15.58}
        },
        "2x4 - 2400": {
            11.875: {12: 18.00, 16: 15.75, 19.2: 13.92, 24: 11.50},
            12.5: {12: 18.75, 16: 16.42, 19.2: 14.50, 24: 11.92},
            14: {12: 20.50, 16: 17.67, 19.2: 15.25, 24: 12.75},
            16: {12: 22.75, 16: 18.92, 19.2: 16.42, 24: 13.67},
            18: {12: 24.83, 16: 20.17, 19.2: 17.50, 24: 14.50},
            20: {12: 26.50, 16: 21.42, 19.2: 18.58, 24: 15.42},
            22: {12: 28.00, 16: 22.58, 19.2: 19.50, 24: 16.25},
            24: {12: 29.33, 16: 23.67, 19.2: 20.42, 24: 17.08}
        }
    },
    "100_35": { // 100 lb/pi² live + 35 lb/pi² dead
        "2x3 - EPS": {
            11.875: {12: 11.08, 16: 8.67, 19.2: 7.33, 24: 5.50},
            12.5: {12: 11.50, 16: 8.92, 19.2: 7.58, 24: 5.75},
            14: {12: 12.25, 16: 9.58, 19.2: 8.08, 24: 6.08},
            16: {12: 13.17, 16: 10.25, 19.2: 8.58, 24: 6.50},
            18: {12: 0, 16: 0, 19.2: 0, 24: 0},
            20: {12: 0, 16: 0, 19.2: 0, 24: 0},
            22: {12: 0, 16: 0, 19.2: 0, 24: 0},
            24: {12: 0, 16: 0, 19.2: 0, 24: 0}
        },
        "2x3 - 1650": {
            11.875: {12: 13.42, 16: 11.33, 19.2: 10.00, 24: 8.00},
            12.5: {12: 13.75, 16: 11.67, 19.2: 10.25, 24: 8.25},
            14: {12: 14.67, 16: 12.42, 19.2: 10.92, 24: 8.75},
            16: {12: 15.75, 16: 13.25, 19.2: 11.67, 24: 9.42},
            18: {12: 0, 16: 0, 19.2: 0, 24: 0},
            20: {12: 0, 16: 0, 19.2: 0, 24: 0},
            22: {12: 0, 16: 0, 19.2: 0, 24: 0},
            24: {12: 0, 16: 0, 19.2: 0, 24: 0}
        },
        "2x3 - 2100": {
            11.875: {12: 14.58, 16: 13.08, 19.2: 11.50, 24: 9.42},
            12.5: {12: 15.17, 16: 13.58, 19.2: 11.92, 24: 9.75},
            14: {12: 16.58, 16: 14.42, 19.2: 12.67, 24: 10.33},
            16: {12: 18.33, 16: 15.50, 19.2: 13.50, 24: 11.17},
            18: {12: 0, 16: 0, 19.2: 0, 24: 0},
            20: {12: 0, 16: 0, 19.2: 0, 24: 0},
            22: {12: 0, 16: 0, 19.2: 0, 24: 0},
            24: {12: 0, 16: 0, 19.2: 0, 24: 0}
        },
        "2x4 - 2100": {
            11.875: {12: 16.25, 16: 14.17, 19.2: 12.08, 24: 9.83},
            12.5: {12: 16.92, 16: 14.67, 19.2: 12.50, 24: 10.17},
            14: {12: 18.58, 16: 15.58, 19.2: 13.33, 24: 10.83},
            16: {12: 20.58, 16: 16.75, 19.2: 14.33, 24: 11.67},
            18: {12: 22.33, 16: 17.75, 19.2: 15.25, 24: 12.42},
            20: {12: 23.67, 16: 18.75, 19.2: 16.17, 24: 13.17},
            22: {12: 24.92, 16: 19.75, 19.2: 17.00, 24: 13.92},
            24: {12: 26.17, 16: 20.75, 19.2: 17.83, 24: 14.58}
        },
        "2x4 - 2400": {
            11.875: {12: 16.92, 16: 14.83, 19.2: 13.08, 24: 10.75},
            12.5: {12: 17.67, 16: 15.42, 19.2: 13.58, 24: 11.17},
            14: {12: 19.33, 16: 16.58, 19.2: 14.33, 24: 11.92},
            16: {12: 21.42, 16: 17.75, 19.2: 15.42, 24: 12.83},
            18: {12: 23.33, 16: 18.92, 19.2: 16.42, 24: 13.67},
            20: {12: 24.92, 16: 20.08, 19.2: 17.42, 24: 14.50},
            22: {12: 26.33, 16: 21.17, 19.2: 18.33, 24: 15.25},
            24: {12: 27.67, 16: 22.25, 19.2: 19.17, 24: 16.00}
        }
    }
};

// Données des solives CCQ basées sur le Tableau 9.23.4.2.-A du Code de construction du Québec
const ccqJoistData = {
    "douglas-fir-larch": {
        "select-structural": {
            "38x89": {
                "lattes-continues": {300: 2.13, 400: 1.97, 600: 1.73},
                "entretoises": {300: 2.19, 400: 1.99, 600: 1.73},
                "lattes-entretoises": {300: 2.19, 400: 1.99, 600: 1.73}
            },
            "38x140": {
                "lattes-continues": {300: 3.23, 400: 3.07, 600: 2.73},
                "entretoises": {300: 3.44, 400: 3.12, 600: 2.73},
                "lattes-entretoises": {300: 3.44, 400: 3.12, 600: 2.73}
            },
            "38x184": {
                "lattes-continues": {300: 3.88, 400: 3.69, 600: 3.51},
                "entretoises": {300: 4.18, 400: 3.92, 600: 3.59},
                "lattes-entretoises": {300: 4.37, 400: 4.07, 600: 3.59}
            },
            "38x235": {
                "lattes-continues": {300: 4.57, 400: 4.34, 600: 4.13},
                "entretoises": {300: 4.86, 400: 4.57, 600: 4.29},
                "lattes-entretoises": {300: 5.05, 400: 4.70, 600: 4.39}
            },
            "38x286": {
                "lattes-continues": {300: 5.21, 400: 4.95, 600: 4.71},
                "entretoises": {300: 5.49, 400: 5.16, 600: 4.85},
                "lattes-entretoises": {300: 5.66, 400: 5.28, 600: 4.92}
            }
        },
        "no1-2": {
            "38x89": {
                "lattes-continues": {300: 2.00, 400: 1.85, 600: 1.66},
                "entretoises": {300: 2.09, 400: 1.90, 600: 1.66},
                "lattes-entretoises": {300: 2.09, 400: 1.90, 600: 1.66}
            },
            "38x140": {
                "lattes-continues": {300: 3.09, 400: 2.91, 600: 2.62},
                "entretoises": {300: 3.29, 400: 2.99, 600: 2.62},
                "lattes-entretoises": {300: 3.29, 400: 2.99, 600: 2.62}
            },
            "38x184": {
                "lattes-continues": {300: 3.71, 400: 3.53, 600: 3.36},
                "entretoises": {300: 4.00, 400: 3.76, 600: 3.44},
                "lattes-entretoises": {300: 4.19, 400: 3.90, 600: 3.44}
            },
            "38x235": {
                "lattes-continues": {300: 4.38, 400: 4.16, 600: 3.96},
                "entretoises": {300: 4.66, 400: 4.38, 600: 4.11},
                "lattes-entretoises": {300: 4.84, 400: 4.51, 600: 4.20}
            },
            "38x286": {
                "lattes-continues": {300: 4.99, 400: 4.75, 600: 4.52},
                "entretoises": {300: 5.26, 400: 4.94, 600: 4.65},
                "lattes-entretoises": {300: 5.43, 400: 5.06, 600: 4.72}
            }
        },
        "no3": {
            "38x89": {
                "lattes-continues": {300: 1.90, 400: 1.69, 600: 1.38},
                "entretoises": {300: 1.95, 400: 1.69, 600: 1.38},
                "lattes-entretoises": {300: 1.95, 400: 1.69, 600: 1.38}
            },
            "38x140": {
                "lattes-continues": {300: 2.78, 400: 2.41, 600: 1.97},
                "entretoises": {300: 2.78, 400: 2.41, 600: 1.97},
                "lattes-entretoises": {300: 2.78, 400: 2.41, 600: 1.97}
            },
            "38x184": {
                "lattes-continues": {300: 3.38, 400: 2.93, 600: 2.39},
                "entretoises": {300: 3.38, 400: 2.93, 600: 2.39},
                "lattes-entretoises": {300: 3.38, 400: 2.93, 600: 2.39}
            },
            "38x235": {
                "lattes-continues": {300: 4.14, 400: 3.58, 600: 2.93},
                "entretoises": {300: 4.14, 400: 3.58, 600: 2.93},
                "lattes-entretoises": {300: 4.14, 400: 3.58, 600: 2.93}
            },
            "38x286": {
                "lattes-continues": {300: 4.80, 400: 4.16, 600: 3.39},
                "entretoises": {300: 4.80, 400: 4.16, 600: 3.39},
                "lattes-entretoises": {300: 4.80, 400: 4.16, 600: 3.39}
            }
        },
        "construction": {
            "38x89": {
                "lattes-continues": {300: 1.90, 400: 1.77, 600: 1.61},
                "entretoises": {300: 2.03, 400: 1.84, 600: 1.61},
                "lattes-entretoises": {300: 2.03, 400: 1.84, 600: 1.61}
            }
        },
        "standard": {
            "38x89": {
                "lattes-continues": {300: 1.81, 400: 1.63, 600: 1.33},
                "entretoises": {300: 1.88, 400: 1.63, 600: 1.33},
                "lattes-entretoises": {300: 1.88, 400: 1.63, 600: 1.33}
            }
        }
    },
    "hem-fir": {
        "select-structural": {
            "38x89": {
                "lattes-continues": {300: 2.08, 400: 1.93, 600: 1.71},
                "entretoises": {300: 2.16, 400: 1.96, 600: 1.71},
                "lattes-entretoises": {300: 2.16, 400: 1.96, 600: 1.71}
            },
            "38x140": {
                "lattes-continues": {300: 3.18, 400: 3.03, 600: 2.69},
                "entretoises": {300: 3.39, 400: 3.08, 600: 2.69},
                "lattes-entretoises": {300: 3.39, 400: 3.08, 600: 2.69}
            },
            "38x184": {
                "lattes-continues": {300: 3.82, 400: 3.64, 600: 3.46},
                "entretoises": {300: 4.12, 400: 3.87, 600: 3.54},
                "lattes-entretoises": {300: 4.31, 400: 4.02, 600: 3.54}
            },
            "38x235": {
                "lattes-continues": {300: 4.50, 400: 4.28, 600: 4.08},
                "entretoises": {300: 4.80, 400: 4.51, 600: 4.23},
                "lattes-entretoises": {300: 4.98, 400: 4.64, 600: 4.33}
            },
            "38x286": {
                "lattes-continues": {300: 5.14, 400: 4.89, 600: 4.65},
                "entretoises": {300: 5.42, 400: 5.09, 600: 4.78},
                "lattes-entretoises": {300: 5.59, 400: 5.21, 600: 4.86}
            }
        },
        "no1-2": {
            "38x89": {
                "lattes-continues": {300: 2.00, 400: 1.85, 600: 1.66},
                "entretoises": {300: 2.09, 400: 1.90, 600: 1.66},
                "lattes-entretoises": {300: 2.09, 400: 1.90, 600: 1.66}
            },
            "38x140": {
                "lattes-continues": {300: 3.09, 400: 2.91, 600: 2.62},
                "entretoises": {300: 3.29, 400: 2.99, 600: 2.62},
                "lattes-entretoises": {300: 3.29, 400: 2.99, 600: 2.62}
            },
            "38x184": {
                "lattes-continues": {300: 3.71, 400: 3.53, 600: 3.36},
                "entretoises": {300: 4.00, 400: 3.76, 600: 3.44},
                "lattes-entretoises": {300: 4.19, 400: 3.90, 600: 3.44}
            },
            "38x235": {
                "lattes-continues": {300: 4.38, 400: 4.16, 600: 3.96},
                "entretoises": {300: 4.66, 400: 4.38, 600: 4.11},
                "lattes-entretoises": {300: 4.84, 400: 4.51, 600: 4.20}
            },
            "38x286": {
                "lattes-continues": {300: 4.99, 400: 4.75, 600: 4.52},
                "entretoises": {300: 5.26, 400: 4.94, 600: 4.65},
                "lattes-entretoises": {300: 5.43, 400: 5.06, 600: 4.72}
            }
        },
        "no3": {
            "38x89": {
                "lattes-continues": {300: 1.90, 400: 1.77, 600: 1.61},
                "entretoises": {300: 2.03, 400: 1.84, 600: 1.61},
                "lattes-entretoises": {300: 2.03, 400: 1.84, 600: 1.61}
            },
            "38x140": {
                "lattes-continues": {300: 2.99, 400: 2.78, 600: 2.43},
                "entretoises": {300: 3.19, 400: 2.90, 600: 2.43},
                "lattes-entretoises": {300: 3.19, 400: 2.90, 600: 2.43}
            },
            "38x184": {
                "lattes-continues": {300: 3.60, 400: 3.42, 600: 2.95},
                "entretoises": {300: 3.88, 400: 3.61, 600: 2.95},
                "lattes-entretoises": {300: 4.06, 400: 3.61, 600: 2.95}
            },
            "38x235": {
                "lattes-continues": {300: 4.24, 400: 4.03, 600: 3.61},
                "entretoises": {300: 4.51, 400: 4.24, 600: 3.61},
                "lattes-entretoises": {300: 4.68, 400: 4.37, 600: 3.61}
            },
            "38x286": {
                "lattes-continues": {300: 4.84, 400: 4.60, 600: 4.19},
                "entretoises": {300: 5.10, 400: 4.79, 600: 4.19},
                "lattes-entretoises": {300: 5.26, 400: 4.90, 600: 4.19}
            }
        },
        "construction": {
            "38x89": {
                "lattes-continues": {300: 1.90, 400: 1.77, 600: 1.61},
                "entretoises": {300: 2.03, 400: 1.84, 600: 1.61},
                "lattes-entretoises": {300: 2.03, 400: 1.84, 600: 1.61}
            }
        },
        "standard": {
            "38x89": {
                "lattes-continues": {300: 1.81, 400: 1.68, 600: 1.39},
                "entretoises": {300: 1.96, 400: 1.71, 600: 1.39},
                "lattes-entretoises": {300: 1.96, 400: 1.71, 600: 1.39}
            }
        }
    },
    "spruce-pine-fir": {
        "select-structural": {
            "38x89": {
                "lattes-continues": {300: 1.95, 400: 1.81, 600: 1.64},
                "entretoises": {300: 2.06, 400: 1.87, 600: 1.64},
                "lattes-entretoises": {300: 2.06, 400: 1.87, 600: 1.64}
            },
            "38x140": {
                "lattes-continues": {300: 3.05, 400: 2.85, 600: 2.57},
                "entretoises": {300: 3.24, 400: 2.95, 600: 2.57},
                "lattes-entretoises": {300: 3.24, 400: 2.95, 600: 2.57}
            },
            "38x184": {
                "lattes-continues": {300: 3.66, 400: 3.48, 600: 3.31},
                "entretoises": {300: 3.94, 400: 3.70, 600: 3.38},
                "lattes-entretoises": {300: 4.12, 400: 3.84, 600: 3.38}
            },
            "38x235": {
                "lattes-continues": {300: 4.31, 400: 4.10, 600: 3.90},
                "entretoises": {300: 4.59, 400: 4.31, 600: 4.05},
                "lattes-entretoises": {300: 4.76, 400: 4.44, 600: 4.14}
            },
            "38x286": {
                "lattes-continues": {300: 4.91, 400: 4.67, 600: 4.45},
                "entretoises": {300: 5.18, 400: 4.87, 600: 4.57},
                "lattes-entretoises": {300: 5.34, 400: 4.98, 600: 4.64}
            }
        },
        "no1-2": {
            "38x89": {
                "lattes-continues": {300: 1.86, 400: 1.72, 600: 1.58},
                "entretoises": {300: 1.99, 400: 1.81, 600: 1.58},
                "lattes-entretoises": {300: 1.99, 400: 1.81, 600: 1.58}
            },
            "38x140": {
                "lattes-continues": {300: 2.92, 400: 2.71, 600: 2.49},
                "entretoises": {300: 3.14, 400: 2.85, 600: 2.49},
                "lattes-entretoises": {300: 3.14, 400: 2.85, 600: 2.49}
            },
            "38x184": {
                "lattes-continues": {300: 3.54, 400: 3.36, 600: 3.20},
                "entretoises": {300: 3.81, 400: 3.58, 600: 3.27},
                "lattes-entretoises": {300: 3.99, 400: 3.72, 600: 3.27}
            },
            "38x235": {
                "lattes-continues": {300: 4.17, 400: 3.96, 600: 3.77},
                "entretoises": {300: 4.44, 400: 4.17, 600: 3.92},
                "lattes-entretoises": {300: 4.60, 400: 4.29, 600: 4.00}
            },
            "38x286": {
                "lattes-continues": {300: 4.75, 400: 4.52, 600: 4.30},
                "entretoises": {300: 5.01, 400: 4.71, 600: 4.42},
                "lattes-entretoises": {300: 5.17, 400: 4.82, 600: 4.49}
            }
        },
        "no3": {
            "38x89": {
                "lattes-continues": {300: 1.81, 400: 1.68, 600: 1.55},
                "entretoises": {300: 1.96, 400: 1.78, 600: 1.55},
                "lattes-entretoises": {300: 1.96, 400: 1.78, 600: 1.55}
            },
            "38x140": {
                "lattes-continues": {300: 2.84, 400: 2.64, 600: 2.43},
                "entretoises": {300: 3.08, 400: 2.80, 600: 2.43},
                "lattes-entretoises": {300: 3.08, 400: 2.80, 600: 2.43}
            },
            "38x184": {
                "lattes-continues": {300: 3.47, 400: 3.30, 600: 2.95},
                "entretoises": {300: 3.74, 400: 3.52, 600: 2.95},
                "lattes-entretoises": {300: 3.92, 400: 3.61, 600: 2.95}
            },
            "38x235": {
                "lattes-continues": {300: 4.09, 400: 3.89, 600: 3.61},
                "entretoises": {300: 4.36, 400: 4.09, 600: 3.61},
                "lattes-entretoises": {300: 4.52, 400: 4.22, 600: 3.61}
            },
            "38x286": {
                "lattes-continues": {300: 4.67, 400: 4.44, 600: 4.19},
                "entretoises": {300: 4.92, 400: 4.62, 600: 4.19},
                "lattes-entretoises": {300: 5.08, 400: 4.73, 600: 4.19}
            }
        },
        "construction": {
            "38x89": {
                "lattes-continues": {300: 1.81, 400: 1.68, 600: 1.55},
                "entretoises": {300: 1.96, 400: 1.78, 600: 1.55},
                "lattes-entretoises": {300: 1.96, 400: 1.78, 600: 1.55}
            }
        },
        "standard": {
            "38x89": {
                "lattes-continues": {300: 1.70, 400: 1.58, 600: 1.44},
                "entretoises": {300: 1.88, 400: 1.71, 600: 1.44},
                "lattes-entretoises": {300: 1.88, 400: 1.71, 600: 1.44}
            }
        }
    },
    "northern-species": {
        "select-structural": {
            "38x89": {
                "lattes-continues": {300: 1.65, 400: 1.53, 600: 1.42},
                "entretoises": {300: 1.84, 400: 1.68, 600: 1.46},
                "lattes-entretoises": {300: 1.84, 400: 1.68, 600: 1.46}
            },
            "38x140": {
                "lattes-continues": {300: 2.59, 400: 2.41, 600: 2.24},
                "entretoises": {300: 2.90, 400: 2.63, 600: 2.30},
                "lattes-entretoises": {300: 2.90, 400: 2.63, 600: 2.30}
            },
            "38x184": {
                "lattes-continues": {300: 3.27, 400: 3.11, 600: 2.94},
                "entretoises": {300: 3.52, 400: 3.31, 600: 3.03},
                "lattes-entretoises": {300: 3.69, 400: 3.44, 600: 3.03}
            },
            "38x235": {
                "lattes-continues": {300: 3.85, 400: 3.66, 600: 3.48},
                "entretoises": {300: 4.10, 400: 3.85, 600: 3.62},
                "lattes-entretoises": {300: 4.26, 400: 3.97, 600: 3.70}
            },
            "38x286": {
                "lattes-continues": {300: 4.39, 400: 4.18, 600: 3.97},
                "entretoises": {300: 4.63, 400: 4.35, 600: 4.09},
                "lattes-entretoises": {300: 4.78, 400: 4.45, 600: 4.15}
            }
        },
        "no1-2": {
            "38x89": {
                "lattes-continues": {300: 1.59, 400: 1.48, 600: 1.37},
                "entretoises": {300: 1.80, 400: 1.64, 600: 1.43},
                "lattes-entretoises": {300: 1.80, 400: 1.64, 600: 1.43}
            },
            "38x140": {
                "lattes-continues": {300: 2.51, 400: 2.33, 600: 2.16},
                "entretoises": {300: 2.83, 400: 2.57, 600: 2.25},
                "lattes-entretoises": {300: 2.83, 400: 2.57, 600: 2.25}
            },
            "38x184": {
                "lattes-continues": {300: 3.19, 400: 3.04, 600: 2.84},
                "entretoises": {300: 3.44, 400: 3.23, 600: 2.96},
                "lattes-entretoises": {300: 3.60, 400: 3.36, 600: 2.96}
            },
            "38x235": {
                "lattes-continues": {300: 3.76, 400: 3.58, 600: 3.41},
                "entretoises": {300: 4.01, 400: 3.77, 600: 3.54},
                "lattes-entretoises": {300: 4.16, 400: 3.88, 600: 3.62}
            },
            "38x286": {
                "lattes-continues": {300: 4.29, 400: 4.08, 600: 3.88},
                "entretoises": {300: 4.53, 400: 4.25, 600: 4.00},
                "lattes-entretoises": {300: 4.67, 400: 4.35, 600: 4.06}
            }
        },
        "no3": {
            "38x89": {
                "lattes-continues": {300: 1.54, 400: 1.43, 600: 1.32},
                "entretoises": {300: 1.74, 400: 1.57, 600: 1.36},
                "lattes-entretoises": {300: 1.76, 400: 1.60, 600: 1.36}
            },
            "38x140": {
                "lattes-continues": {300: 2.42, 400: 2.24, 600: 1.94},
                "entretoises": {300: 2.74, 400: 2.38, 600: 1.94},
                "lattes-entretoises": {300: 2.75, 400: 2.38, 600: 1.94}
            },
            "38x184": {
                "lattes-continues": {300: 3.12, 400: 2.90, 600: 2.37},
                "entretoises": {300: 3.35, 400: 2.90, 600: 2.37},
                "lattes-entretoises": {300: 3.35, 400: 2.90, 600: 2.37}
            },
            "38x235": {
                "lattes-continues": {300: 3.67, 400: 3.49, 600: 2.89},
                "entretoises": {300: 3.91, 400: 3.54, 600: 2.89},
                "lattes-entretoises": {300: 4.06, 400: 3.54, 600: 2.89}
            },
            "38x286": {
                "lattes-continues": {300: 4.19, 400: 3.98, 600: 3.36},
                "entretoises": {300: 4.42, 400: 4.11, 600: 3.36},
                "lattes-entretoises": {300: 4.55, 400: 4.11, 600: 3.36}
            }
        },
        "construction": {
            "38x89": {
                "lattes-continues": {300: 1.54, 400: 1.43, 600: 1.32},
                "entretoises": {300: 1.74, 400: 1.57, 600: 1.40},
                "lattes-entretoises": {300: 1.76, 400: 1.60, 600: 1.40}
            }
        },
        "standard": {
            "38x89": {
                "lattes-continues": {300: 1.48, 400: 1.37, 600: 1.15},
                "entretoises": {300: 1.63, 400: 1.41, 600: 1.15},
                "lattes-entretoises": {300: 1.63, 400: 1.41, 600: 1.15}
            }
        }
    }
};

// Fonctions utilitaires
function parseSpan(spanStr) {
    if (!spanStr || spanStr === "n/d") return 0;
    const parts = spanStr.split('-');
    const feet = parseInt(parts[0]);
    const inches = parseInt(parts[1]);
    return feet + inches/12;
}

function formatSpan(totalFeet) {
    const feet = Math.floor(totalFeet);
    const inches = Math.round((totalFeet - feet) * 12);
    return `${feet}'-${inches}"`;
}

function showTab(tabName) {
    // Masquer tous les contenus d'onglets
    const contents = document.querySelectorAll('.tab-content');
    contents.forEach(content => content.classList.remove('active'));
    
    // Retirer la classe active de tous les onglets
    const tabs = document.querySelectorAll('.tab');
    tabs.forEach(tab => tab.classList.remove('active'));
    
    // Afficher le contenu de l'onglet sélectionné
    document.getElementById(tabName).classList.add('active');
    
    // Ajouter la classe active à l'onglet correspondant
    const activeTab = Array.from(tabs).find(tab => 
        tab.getAttribute('onclick').includes(tabName)
    );
    if (activeTab) {
        activeTab.classList.add('active');
    }
}

function selectionnerPoutrelle(index, tabType) {
    // Retirer la sélection précédente
    document.querySelectorAll('.poutrelle-option').forEach(option => {
        option.classList.remove('selected');
    });
    
    // Ajouter la sélection à l'option cliquée
    document.querySelectorAll('.poutrelle-option')[index].classList.add('selected');
}

// Fonctions pour les poutrelles en I
function calculerPoutrellesI() {
    // Récupération des valeurs d'entrée
    const porteePieds = parseFloat(document.getElementById('porteePieds-i').value) || 0;
    const porteePouces = parseFloat(document.getElementById('porteePouces-i').value) || 0;
    const portee = porteePieds + (porteePouces / 12);
    
    const chargeMorte = parseFloat(document.getElementById('chargeMorte-i').value);
    const chargeVive = parseFloat(document.getElementById('chargeVive-i').value);
    const chargeViveNeige = parseFloat(document.getElementById('chargeViveNeige-i').value) || 0;
    const subfloorThickness = document.getElementById('subfloorThickness-i').value;
    const attachment = document.querySelector('input[name="subfloor-attachment-i"]:checked').value;
    const spanType = document.querySelector('input[name="span-type-i"]:checked').value;
    const gypsum = document.querySelector('input[name="gypsum-i"]:checked').value;
    const hauteurMax = parseFloat(document.getElementById('hauteurMax-i').value) || 999;
    const espacementPrefere = document.getElementById('espacementPrefere-i').value;

    // Validation des entrées - vérifier que les valeurs requises sont présentes et valides
    if (portee <= 0 || isNaN(chargeMorte) || isNaN(chargeVive) || chargeMorte <= 0 || chargeVive <= 0) {
        resetResultsI();
        return;
    }

    // Calculs selon la méthodologie
    const chargeTotaleNonPonderee = chargeMorte + Math.max(chargeVive, chargeViveNeige);
    const chargeTotalePonderee = 1.25 * chargeMorte + 1.5 * Math.max(chargeVive, chargeViveNeige);

    // Affichage des résultats de calcul
    document.getElementById('resultTotaleNonPonderee-i').textContent = `${chargeTotaleNonPonderee.toFixed(0)} lb/pi.ca.`;
    document.getElementById('resultTotalePonderee-i').textContent = `${chargeTotalePonderee.toFixed(0)} lb/pi.ca.`;

    // Recherche des poutrelles viables
    const poutrellesViables = trouverPoutrellesViablesI(portee, subfloorThickness, attachment, spanType, gypsum, hauteurMax, espacementPrefere);
    
    afficherResultatsPoutrellesI(poutrellesViables, chargeTotaleNonPonderee, chargeTotalePonderee);
}

function trouverPoutrellesViablesI(portee, subfloorThickness, attachment, spanType, gypsum, hauteurMax, espacementPrefere) {
    const poutrellesViables = [];
    
    // Vérifier toutes les séries
    for (const [seriesName, seriesData] of Object.entries(iJoistData)) {
        if (seriesData.spans[subfloorThickness] && seriesData.spans[subfloorThickness][attachment]) {
            const spanTypeData = seriesData.spans[subfloorThickness][attachment][spanType];
            if (!spanTypeData) continue;
            
            const gypsumData = spanTypeData[gypsum === "no" ? "no_gypsum" : "half_gypsum"];
            if (!gypsumData) continue;
            
            for (const height of seriesData.heights) {
                if (height > hauteurMax) continue;
                
                const heightData = gypsumData[height];
                if (!heightData) continue;
                
                const spacings = espacementPrefere ? [parseFloat(espacementPrefere)] : [12, 16, 19.2, 24];
                
                for (const spacing of spacings) {
                    const spanStr = heightData[spacing];
                    if (!spanStr || spanStr === "n/d") continue;
                    
                    const allowableSpan = parseSpan(spanStr);
                    
                    if (allowableSpan >= portee) {
                        poutrellesViables.push({
                            series: seriesName,
                            height: height,
                            spacing: spacing,
                            maxSpan: spanStr,
                            allowableSpanFt: allowableSpan,
                            ratio: allowableSpan / portee
                        });
                    }
                }
            }
        }
    }
    
    // Trier par ratio (le plus élevé en premier), puis par espacement (le plus grand en premier)
    poutrellesViables.sort((a, b) => {
        if (Math.abs(a.ratio - b.ratio) < 0.01) {
            return b.spacing - a.spacing;
        }
        return b.ratio - a.ratio;
    });
    
    return poutrellesViables;
}

function afficherResultatsPoutrellesI(poutrellesViables, chargeTotaleNonPonderee, chargeTotalePonderee) {
    const container = document.getElementById('poutrelleResults-i');
    
    if (poutrellesViables.length === 0) {
        container.innerHTML = `
            <div class="no-solution">
                <h3>Aucune poutrelle viable trouvée</h3>
                <p>Les paramètres entrés ne permettent pas de trouver une solution viable.</p>
                <p>Suggestions :</p>
                <ul style="text-align: left; margin-top: 10px;">
                    <li>Augmenter la hauteur maximale</li>
                    <li>Réduire la portée</li>
                    <li>Considérer des appuis intermédiaires</li>
                </ul>
            </div>
        `;
        return;
    }

    let html = `
        <div class="poutrelle-options">
            <h3 style="margin-bottom: 20px; color: #D2691E;">
                Poutrelles viables (${poutrellesViables.length} option${poutrellesViables.length > 1 ? 's' : ''})
            </h3>
    `;

    poutrellesViables.forEach((poutrelle, index) => {
        const utilizationPercent = ((1 / poutrelle.ratio) * 100).toFixed(0);
        
        html += `
            <div class="poutrelle-option" onclick="selectionnerPoutrelle(${index}, 'i')">
                <div class="poutrelle-title">
                    ${poutrelle.series} - ${poutrelle.height}" @ ${poutrelle.spacing}" c/c
                </div>
                <div class="poutrelle-specs">
                    <div><strong>Portée max:</strong> ${poutrelle.maxSpan}</div>
                    <div><strong>Utilisation:</strong> ${utilizationPercent}%</div>
                    <div><strong>Ratio:</strong> ${poutrelle.ratio.toFixed(2)}</div>
                    <div><strong>Espacement:</strong> ${poutrelle.spacing}"</div>
                </div>
            </div>
        `;
    });

    html += `
        <div style="margin-top: 20px; padding: 15px; background: #fff3cd; border-radius: 8px; font-size: 0.9em;">
            <strong>Charges de conception:</strong><br>
            Charge totale non pondérée: ${chargeTotaleNonPonderee.toFixed(0)} lb/pi.ca. | 
            Charge totale pondérée: ${chargeTotalePonderee.toFixed(0)} lb/pi.ca.
        </div>
    `;

    html += '</div>';
    container.innerHTML = html;
}

function resetResultsI() {
    document.getElementById('resultTotaleNonPonderee-i').textContent = '-';
    document.getElementById('resultTotalePonderee-i').textContent = '-';
    document.getElementById('poutrelleResults-i').innerHTML = `
        <p style="text-align: center; color: #A0522D; margin-top: 50px;">
            Entrez les paramètres pour voir les options de poutrelles.
        </p>
    `;
}

// Fonctions pour les poutrelles ajourées
function calculerPoutrellesAjourees() {
    // Récupération des valeurs d'entrée
    const porteePieds = parseFloat(document.getElementById('porteePieds-a').value) || 0;
    const porteePouces = parseFloat(document.getElementById('porteePouces-a').value) || 0;
    const portee = porteePieds + (porteePouces / 12);
    
    const chargeMorte = parseFloat(document.getElementById('chargeMorte-a').value);
    const chargeVive = parseFloat(document.getElementById('chargeVive-a').value);
    const espacement = parseFloat(document.getElementById('espacement-a').value);
    const hauteurMax = parseFloat(document.getElementById('hauteurMax-a').value) || 999;

    // Validation des entrées - vérifier que les valeurs requises sont présentes et valides
    if (portee <= 0 || isNaN(chargeMorte) || isNaN(chargeVive) || isNaN(espacement) || chargeMorte <= 0 || chargeVive <= 0 || espacement <= 0) {
        resetResultsA();
        return;
    }

    // Affichage des charges appliquées
    document.getElementById('resultChargesAppliquees-a').textContent = `${chargeMorte} + ${chargeVive} lb/pi.ca.`;

    // Déterminer le cas de charge
    const loadCase = `${chargeVive}_${chargeMorte}`;
    const data = openWebJoistData[loadCase];
    
    if (!data) {
        document.getElementById('poutrelleResults-a').innerHTML = `
            <div class="no-solution">
                <h3>Combinaison de charges non supportée</h3>
                <p>Les charges ${chargeVive} lb/pi² (CV) + ${chargeMorte} lb/pi² (CM) ne sont pas dans les tables disponibles.</p>
            </div>
        `;
        return;
    }

    // Recherche des poutrelles viables
    const poutrellesViables = trouverPoutrellesViablesA(data, portee, espacement, hauteurMax);
    afficherResultatsPoutrellesA(poutrellesViables, chargeMorte, chargeVive, portee, espacement);
}

function trouverPoutrellesViablesA(data, portee, espacement, hauteurMax) {
    const poutrellesViables = [];
    
    // Vérifier toutes les séries et hauteurs
    for (const [series, heightData] of Object.entries(data)) {
        for (const [heightStr, spacingData] of Object.entries(heightData)) {
            const height = parseFloat(heightStr);
            if (height > hauteurMax) continue;
            
            const allowableSpan = spacingData[espacement];
            if (allowableSpan && allowableSpan > 0) {
                const ratio = allowableSpan / portee;
                poutrellesViables.push({
                    series: series,
                    height: height,
                    allowableSpan: allowableSpan,
                    ratio: ratio
                });
            }
        }
    }
    
    // Trier par ratio (le plus élevé en premier)
    poutrellesViables.sort((a, b) => b.ratio - a.ratio);
    
    return poutrellesViables;
}

function afficherResultatsPoutrellesA(poutrellesViables, chargeMorte, chargeVive, portee, espacement) {
    const container = document.getElementById('poutrelleResults-a');
    const statusBox = document.getElementById('status-box-a');
    const statusElement = document.getElementById('resultStatut-a');
    
    if (poutrellesViables.length === 0) {
        statusElement.textContent = 'NON CONFORME';
        statusBox.className = 'result-card status-error';
        container.innerHTML = `
            <div class="no-solution">
                <h3>Aucune solution trouvée</h3>
                <p>Aucune poutrelle ajourée ne peut supporter cette portée avec ces charges.</p>
            </div>
        `;
        return;
    }

    const bestOption = poutrellesViables[0];
    
    if (bestOption.ratio >= 1.0) {
        statusElement.textContent = 'CONFORME';
        statusBox.className = 'result-card status-success';
    } else {
        statusElement.textContent = 'NON CONFORME';
        statusBox.className = 'result-card status-error';
    }

    let html = `
        <div class="poutrelle-options">
            <h3 style="margin-bottom: 20px; color: #D2691E;">
                Poutrelles ajourées viables (${poutrellesViables.length} option${poutrellesViables.length > 1 ? 's' : ''})
            </h3>
    `;

    poutrellesViables.forEach((poutrelle, index) => {
        const utilizationPercent = ((1 / poutrelle.ratio) * 100).toFixed(0);
        const statusClass = poutrelle.ratio >= 1.0 ? 'status-success' : 'status-error';
        
        html += `
            <div class="poutrelle-option ${statusClass}" onclick="selectionnerPoutrelle(${index}, 'a')">
                <div class="poutrelle-title">
                    ${poutrelle.series} - ${poutrelle.height}" @ ${espacement}" c/c
                </div>
                <div class="poutrelle-specs">
                    <div><strong>Portée admissible:</strong> ${formatSpan(poutrelle.allowableSpan)}</div>
                    <div><strong>Ratio:</strong> ${poutrelle.ratio.toFixed(2)}</div>
                    <div><strong>Utilisation:</strong> ${utilizationPercent}%</div>
                    <div><strong>Statut:</strong> ${poutrelle.ratio >= 1.0 ? 'Conforme' : 'Non conforme'}</div>
                </div>
            </div>
        `;
    });

    html += `
        <div style="margin-top: 20px; padding: 15px; background: #fff3cd; border-radius: 8px; font-size: 0.9em;">
            <strong>Paramètres de conception:</strong><br>
            Portée demandée: ${formatSpan(portee)} | 
            Charges: ${chargeMorte} + ${chargeVive} lb/pi.ca. | 
            Espacement: ${espacement}"
        </div>
    `;

    html += '</div>';
    container.innerHTML = html;
}

function resetResultsA() {
    document.getElementById('resultChargesAppliquees-a').textContent = '-';
    const statusBox = document.getElementById('status-box-a');
    const statusElement = document.getElementById('resultStatut-a');
    statusElement.textContent = '-';
    statusBox.className = 'result-card';
    
    document.getElementById('poutrelleResults-a').innerHTML = `
        <p style="text-align: center; color: #A0522D; margin-top: 50px;">
            Entrez les paramètres pour voir les options de poutrelles ajourées.
        </p>
    `;
}

// Fonctions pour les solives CCQ
function convertMetersToFeetInches(meters) {
    const totalFeet = meters * 3.28084;
    const feet = Math.floor(totalFeet);
    const inches = Math.round((totalFeet - feet) * 12);
    return `${feet}'-${inches}"`;
}

function calculerSolivesCCQ() {
    // Récupération des valeurs d'entrée
    const porteePieds = parseFloat(document.getElementById('porteePieds-ccq').value) || 0;
    const porteePouces = parseFloat(document.getElementById('porteePouces-ccq').value) || 0;
    const porteeMeters = (porteePieds + (porteePouces / 12)) * 0.3048; // Conversion en mètres
    
    const essence = document.getElementById('essence-ccq').value;
    const qualite = document.getElementById('qualite-ccq').value;
    const dimensions = document.getElementById('dimensions-ccq').value;
    const espacement = parseInt(document.getElementById('espacement-ccq').value);
    const support = document.getElementById('support-ccq').value;
    const special = document.querySelector('input[name="special-ccq"]:checked').value;

    // Validation des entrées
    if (porteeMeters <= 0 || !essence || !qualite || !dimensions || !espacement || !support) {
        resetResultsCCQ();
        return;
    }

    // Affichage de la portée demandée
    document.getElementById('resultPorteeDemandee-ccq').textContent = `${porteePieds}'-${porteePouces}"`;

    // Recherche des solives viables
    const solvesViables = trouverSolivesCCQ(essence, qualite, dimensions, espacement, support, porteeMeters, special);
    afficherResultatsSolivesCCQ(solvesViables, porteeMeters, essence, qualite, dimensions, espacement, support);
}

function trouverSolivesCCQ(essence, qualite, dimensions, espacement, support, porteeMeters, special) {
    const solvesViables = [];
    
    // Vérifier si la combinaison existe dans les données CCQ
    if (!ccqJoistData[essence] || !ccqJoistData[essence][qualite] || !ccqJoistData[essence][qualite][dimensions]) {
        return solvesViables;
    }
    
    const dimensionData = ccqJoistData[essence][qualite][dimensions];
    
    if (!dimensionData[support]) {
        return solvesViables;
    }
    
    const porteeMaximale = dimensionData[support][espacement];
    
    if (porteeMaximale && porteeMaximale >= porteeMeters) {
        const ratio = porteeMaximale / porteeMeters;
        solvesViables.push({
            essence: essence,
            qualite: qualite,
            dimensions: dimensions,
            espacement: espacement,
            support: support,
            porteeMaximale: porteeMaximale,
            ratio: ratio
        });
    }
    
    return solvesViables;
}

function afficherResultatsSolivesCCQ(solvesViables, porteeMeters, essence, qualite, dimensions, espacement, support) {
    const container = document.getElementById('soliveResults-ccq');
    const statusBox = document.getElementById('status-box-ccq');
    const statusElement = document.getElementById('resultStatut-ccq');
    
    if (solvesViables.length === 0) {
        statusElement.textContent = 'NON CONFORME';
        statusBox.className = 'result-card status-error';
        container.innerHTML = `
            <div class="no-solution">
                <h3>Aucune solution trouvée</h3>
                <p>La combinaison sélectionnée ne peut supporter cette portée.</p>
                <p>Suggestions :</p>
                <ul style="text-align: left; margin-top: 10px;">
                    <li>Choisir une qualité de bois supérieure</li>
                    <li>Augmenter les dimensions de la solive</li>
                    <li>Réduire l'espacement entre solives</li>
                </ul>
            </div>
        `;
        return;
    }

    const bestOption = solvesViables[0];
    
    if (bestOption.ratio >= 1.0) {
        statusElement.textContent = 'CONFORME';
        statusBox.className = 'result-card status-success';
    } else {
        statusElement.textContent = 'NON CONFORME';
        statusBox.className = 'result-card status-error';
    }

    const utilizationPercent = ((1 / bestOption.ratio) * 100).toFixed(0);
    const porteeMaxStr = convertMetersToFeetInches(bestOption.porteeMaximale);
    
    // Traduction des valeurs pour l'affichage
    const essenceLabels = {
        'douglas-fir-larch': 'Douglas Fir - Larch',
        'hem-fir': 'Hem - Fir',
        'spruce-pine-fir': 'Spruce - Pine - Fir',
        'northern-species': 'Northern Species'
    };
    
    const qualiteLabels = {
        'select-structural': 'Select Structural',
        'no1-2': 'N°s 1 et 2',
        'no3': 'N° 3',
        'construction': 'Construction',
        'standard': 'Standard'
    };
    
    const dimensionsLabels = {
        '38x89': '1½" x 3½"',
        '38x140': '1½" x 5½"',
        '38x184': '1½" x 7¼"',
        '38x235': '1½" x 9¼"',
        '38x286': '1½" x 11¼"'
    };
    
    const supportLabels = {
        'lattes-continues': 'Lattes continues',
        'entretoises': 'Entretoises',
        'lattes-entretoises': 'Lattes continues et entretoises'
    };

    let html = `
        <div class="poutrelle-options">
            <h3 style="margin-bottom: 20px; color: #D2691E;">
                Résultat de calcul CCQ
            </h3>
            
            <div class="poutrelle-option ${bestOption.ratio >= 1.0 ? 'status-success' : 'status-error'}">
                <div class="poutrelle-title">
                    ${essenceLabels[essence]} - ${qualiteLabels[qualite]}
                </div>
                <div class="poutrelle-specs">
                    <div><strong>Dimensions:</strong> ${dimensionsLabels[dimensions]}</div>
                    <div><strong>Espacement:</strong> ${espacement} mm</div>
                    <div><strong>Support:</strong> ${supportLabels[support]}</div>
                    <div><strong>Portée max:</strong> ${porteeMaxStr}</div>
                    <div><strong>Ratio:</strong> ${bestOption.ratio.toFixed(2)}</div>
                    <div><strong>Utilisation:</strong> ${utilizationPercent}%</div>
                </div>
            </div>
        </div>
        
        <div style="margin-top: 20px; padding: 15px; background: #fff3cd; border-radius: 8px; font-size: 0.9em;">
            <strong>Paramètres de conception:</strong><br>
            Essence: ${essenceLabels[essence]} | 
            Qualité: ${qualiteLabels[qualite]} | 
            Portée demandée: ${convertMetersToFeetInches(porteeMeters)}
        </div>
    `;

    container.innerHTML = html;
}

function resetResultsCCQ() {
    document.getElementById('resultPorteeDemandee-ccq').textContent = '-';
    const statusBox = document.getElementById('status-box-ccq');
    const statusElement = document.getElementById('resultStatut-ccq');
    statusElement.textContent = '-';
    statusBox.className = 'result-card';
    
    document.getElementById('soliveResults-ccq').innerHTML = `
        <p style="text-align: center; color: #A0522D; margin-top: 50px;">
            Entrez les paramètres pour voir les options de solives CCQ.
        </p>
    `;
}

// Initialisation
document.addEventListener('DOMContentLoaded', function() {
    // Test initial
    console.log('Calculateur de poutrelles chargé');
    
    // Ajout des écouteurs d'événements pour les poutrelles en I
    const inputsI = ['porteePieds-i', 'porteePouces-i', 'chargeMorte-i', 'chargeVive-i', 'chargeViveNeige-i', 'subfloorThickness-i', 'hauteurMax-i', 'espacementPrefere-i'];
    inputsI.forEach(inputId => {
        const element = document.getElementById(inputId);
        if (element) {
            element.addEventListener('input', function() {
                clearTimeout(this.timer);
                this.timer = setTimeout(calculerPoutrellesI, 300);
            });
            element.addEventListener('change', calculerPoutrellesI);
        } else {
            console.warn(`Element ${inputId} non trouvé`);
        }
    });
    
    // Boutons radio pour les poutrelles en I
    document.querySelectorAll('input[name="subfloor-attachment-i"]').forEach(input => {
        input.addEventListener('change', calculerPoutrellesI);
    });
    document.querySelectorAll('input[name="span-type-i"]').forEach(input => {
        input.addEventListener('change', calculerPoutrellesI);
    });
    document.querySelectorAll('input[name="gypsum-i"]').forEach(input => {
        input.addEventListener('change', calculerPoutrellesI);
    });
    
    // Ajout des écouteurs d'événements pour les poutrelles ajourées
    const inputsA = ['porteePieds-a', 'porteePouces-a', 'chargeMorte-a', 'chargeVive-a', 'espacement-a', 'hauteurMax-a'];
    inputsA.forEach(inputId => {
        const element = document.getElementById(inputId);
        if (element) {
            element.addEventListener('input', function() {
                clearTimeout(this.timer);
                this.timer = setTimeout(calculerPoutrellesAjourees, 300);
            });
            element.addEventListener('change', calculerPoutrellesAjourees);
        } else {
            console.warn(`Element ${inputId} non trouvé`);
        }
    });
    
    // Ajout des écouteurs d'événements pour les solives CCQ
    const inputsCCQ = ['porteePieds-ccq', 'porteePouces-ccq', 'essence-ccq', 'qualite-ccq', 'dimensions-ccq', 'espacement-ccq', 'support-ccq'];
    inputsCCQ.forEach(inputId => {
        const element = document.getElementById(inputId);
        if (element) {
            element.addEventListener('input', function() {
                clearTimeout(this.timer);
                this.timer = setTimeout(calculerSolivesCCQ, 300);
            });
            element.addEventListener('change', calculerSolivesCCQ);
        } else {
            console.warn(`Element ${inputId} non trouvé`);
        }
    });
    
    // Boutons radio pour les solives CCQ
    document.querySelectorAll('input[name="special-ccq"]').forEach(input => {
        input.addEventListener('change', calculerSolivesCCQ);
    });
    
    // Appel initial pour tester
    calculerPoutrellesI();
});
